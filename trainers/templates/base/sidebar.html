{% load static %}

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
        <a class="navbar-brand" href="{% url 'home' %}">
            <img src="{% static 'images/logo/logo.png' %}" alt="Logo" width="40" height="40" class="d-inline-block align-text-top">
            {% if request.organization %} {{ request.organization.name }} {% else %} الجمعية {% endif %}
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="{% url 'home' %}">الرئيسية</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="{% url 'trainees_report' %}">تحميل الوثائق</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="traineesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        المتدربون
                    </a>
                    <ul class="dropdown-menu text-right" aria-labelledby="traineesDropdown">
                        <li><a class="dropdown-item" href="{% url 'trainees' 'كبار' %}">الكبار</a></li><hr>
                        <li><a class="dropdown-item" href="{% url 'trainees' 'شبان' %}">الشبان</a></li><hr>
                        <li><a class="dropdown-item" href="{% url 'trainees' 'فتيان' %}">الفتيان</a></li><hr>
                        <li><a class="dropdown-item" href="{% url 'trainees' 'الصغار' %}">الصغار</a></li><hr>
                        <li><a class="dropdown-item" href="{% url 'trainees' 'نساء' %}">المتدربات النساء</a></li><hr>
                        <li><a class="dropdown-item" href="{% url 'trainees' 'all' %}">الكل</a></li><hr>
                        <li><a class="dropdown-item" href="{% url 'add_trainee' %}">اضافة متدرب جديد</a></li><hr>
                        <li><a class="dropdown-item" href="{% url 'add_women' %}">اضافة امرأة</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="activitiesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        الأنشطة
                    </a>
                    <ul class="dropdown-menu text-right" aria-labelledby="activitiesDropdown">
                        <li><a class="dropdown-item" href="{% url 'articles' 'test' %}">الامتحانات</a></li>
                        <li><a class="dropdown-item" href="{% url 'articles' 'dawri' %}">الدوريات</a></li>
                        <li><a class="dropdown-item" href="{% url 'articles' 'training' %}">التداريب</a></li>
                        <li><a class="dropdown-item" href="{% url 'articles' 'League' %}">البطولات</a></li>
                        <li><a class="dropdown-item" href="{% url 'articles' 'all' %}">الكل</a></li>
                        <li><a class="dropdown-item" href="{% url 'add_article' %}">اضافة</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle " href="#" id="paymentsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        دفعات
                    </a>
                    <ul class="dropdown-menu text-right" aria-labelledby="paymentsDropdown">
                        <li><a class=" bg-success dropdown-item active" aria-current="page" href="{% url 'add_payment' %}">اضافة دفعة جديدة</a></li>
                        <li><a class="dropdown-item" href="{% url 'payments_history' %}">أرشيف الدفعات</a></li>
                        <li><a class="dropdown-item" href="{% url 'unpaid_trainees' %}"> الذين لم يدفعوا</a></li>
                    </ul>
                </li>
                
                {# Only admins see financial menu #}
                {% if is_admin %}
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="financialDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        المالية
                    </a>
                    <ul class="dropdown-menu text-right" aria-labelledby="financialDropdown">
                        <li><a class="dropdown-item" href="{% url 'finantial_status' %}">التقرير المالي</a></li>
                        <hr>
                        <li><a class="dropdown-item" href="{% url 'add_expenses' %}">اضافة مصاريف</a></li>
                        <hr>
                        <li><a class="dropdown-item" href="{% url 'add_payments' %}">اضافة مداخيل</a></li>
                    </ul>
                </li>
                {% else %}
                {# Non-admin users only see logout #}
                {% if user.is_authenticated %}
                <li class="nav-item">
                    <a class="nav-link active" href="{% url 'logout' %}">تسجيل الخروج</a>
                </li>
                {% endif %}
                {% endif %}

            </ul>
            
            {# Admin dropdown - only for admin users #}
            {% if is_admin %}
            <ul class="navbar-nav ms-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        <i class="fas fa-user-circle"></i>
                        <span class="ms-1">
                            {% if staff_member %}{{ staff_member.user.get_full_name|default:staff_member.user.username }}{% else %}المدير{% endif %}
                        </span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end text-right">
                        <li>
                            <div class="dropdown-header">
                                <strong>{{ staff_member.role|default:"مدير" }}</strong>
                                {% if request.organization %}
                                <br><small class="text-muted">{{ request.organization.name }}</small>
                                {% endif %}
                            </div>
                        </li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="{% url 'add_staff' %}">
                            <i class="fas fa-user-plus"></i> موظف جديد
                        </a></li>
                        <li><a class="dropdown-item" href="{% url 'staff_list' %}">
                            <i class="fas fa-building"></i> معلومات الجمعية
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="{% url 'logout' %}">
                            <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                        </a></li>
                    </ul>
                </li>
            </ul>
            {% endif %}
        </div>
    </div>
</nav>